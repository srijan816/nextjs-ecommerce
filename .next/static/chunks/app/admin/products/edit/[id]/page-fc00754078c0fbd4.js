(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9718],{395:(e,r,t)=>{Promise.resolve().then(t.bind(t,1315))},6046:(e,r,t)=>{"use strict";var s=t(6658);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})},1315:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var s=t(5155),a=t(2115),o=t(6046),i=t(8173),c=t.n(i),d=t(2615),n=t(3681),l=t(9615);function u(e){var r;let{params:t}=e,i=(0,o.useRouter)(),{data:u,status:m}=(0,d.useSession)(),[g,h]=(0,a.useState)(!1),[p,x]=(0,a.useState)(!1),[f,y]=(0,a.useState)({id:"",name:"",description:"",category:"",categoryName:"",price:"",image:"",stock:"100",isFeatured:!1,isOnSale:!1}),{getProduct:b,updateProduct:v}=(0,l.Q)();if((0,a.useEffect)(()=>{var e;if("loading"!==m){if("unauthenticated"===m){i.push("/sign-in?callbackUrl=/admin/products/edit/"+t.id);return}if((null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.role)!==n.X.ADMIN){i.push("/");return}}},[u,m,i,t.id]),(0,a.useEffect)(()=>{if("loading"===m)return;if(!u||u.user.role!==n.X.ADMIN){i.push("/");return}let e=b(t.id);if(e){var r;y({id:e.id,name:e.name,description:e.description||"",category:e.category||"",categoryName:e.categoryName||"",price:e.price.toString(),image:e.image||"",stock:(null===(r=e.stock)||void 0===r?void 0:r.toString())||"100",isFeatured:e.isFeatured||!1,isOnSale:e.isOnSale||!1})}h(!0)},[m,u,i,t.id,b]),!g||"loading"===m)return(0,s.jsx)("div",{className:"container mx-auto flex h-[50vh] items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"mb-4 h-12 w-12 animate-spin rounded-full border-4 border-gray-300 border-t-gray-900 mx-auto"}),(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Loading product..."})]})});if("unauthenticated"===m||(null==u?void 0:null===(r=u.user)||void 0===r?void 0:r.role)!==n.X.ADMIN)return null;let N=e=>{let{name:r,value:t,type:s}=e.target;if("checkbox"===s){let t=e.target.checked;y(e=>({...e,[r]:t}))}else y(e=>({...e,[r]:t}))},j=async e=>{e.preventDefault(),x(!0);try{let e={...f,price:parseFloat(f.price),stock:parseInt(f.stock)};v(e),alert("Product updated successfully!"),i.push("/admin/dashboard?tab=products")}catch(e){console.error("Error updating product:",e),alert("Failed to update product. Please try again.")}finally{x(!1)}};return(0,s.jsxs)("div",{className:"container mx-auto py-8",children:[(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Edit Product"}),(0,s.jsx)(c(),{href:"/admin/dashboard?tab=products",className:"rounded-md bg-gray-100 px-4 py-2 text-sm font-medium text-gray-600 hover:bg-gray-200",children:"Back to Products"})]}),(0,s.jsx)("div",{className:"rounded-lg border bg-white p-6 shadow-sm",children:(0,s.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Product Name"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",value:f.name,onChange:N,required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-500 focus:outline-none focus:ring-gray-500 sm:text-sm"})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description"}),(0,s.jsx)("textarea",{id:"description",name:"description",value:f.description,onChange:N,rows:4,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-500 focus:outline-none focus:ring-gray-500 sm:text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,s.jsxs)("select",{id:"category",name:"category",value:f.category,onChange:N,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-500 focus:outline-none focus:ring-gray-500 sm:text-sm",children:[(0,s.jsx)("option",{value:"electronics",children:"Electronics"}),(0,s.jsx)("option",{value:"clothing",children:"Clothing"}),(0,s.jsx)("option",{value:"home-kitchen",children:"Home & Kitchen"}),(0,s.jsx)("option",{value:"beauty",children:"Beauty"}),(0,s.jsx)("option",{value:"fitness",children:"Fitness"}),(0,s.jsx)("option",{value:"accessories",children:"Accessories"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Price ($)"}),(0,s.jsx)("input",{type:"number",id:"price",name:"price",value:f.price,onChange:N,min:"0",step:"0.01",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-500 focus:outline-none focus:ring-gray-500 sm:text-sm"})]}),(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("label",{htmlFor:"image",className:"block text-sm font-medium text-gray-700",children:"Image URL"}),(0,s.jsx)("input",{type:"text",id:"image",name:"image",value:f.image,onChange:N,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-500 focus:outline-none focus:ring-gray-500 sm:text-sm"}),f.image&&(0,s.jsx)("div",{className:"mt-2 h-40 w-40 overflow-hidden rounded-md border",children:(0,s.jsx)("img",{src:f.image,alt:"Product preview",className:"h-full w-full object-cover"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700",children:"Stock"}),(0,s.jsx)("input",{type:"number",id:"stock",name:"stock",value:f.stock,onChange:N,min:"0",required:!0,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-500 focus:outline-none focus:ring-gray-500 sm:text-sm"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isFeatured",name:"isFeatured",checked:f.isFeatured,onChange:N,className:"h-4 w-4 rounded border-gray-300 text-gray-900 focus:ring-gray-500"}),(0,s.jsx)("label",{htmlFor:"isFeatured",className:"ml-2 block text-sm text-gray-700",children:"Featured Product"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isOnSale",name:"isOnSale",checked:f.isOnSale,onChange:N,className:"h-4 w-4 rounded border-gray-300 text-gray-900 focus:ring-gray-500"}),(0,s.jsx)("label",{htmlFor:"isOnSale",className:"ml-2 block text-sm text-gray-700",children:"On Sale"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(c(),{href:"/admin/dashboard?tab=products",className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:p,className:"rounded-md bg-gray-900 px-4 py-2 text-sm font-medium text-white hover:bg-gray-800 disabled:opacity-50",children:p?"Saving...":"Save Changes"})]})]})})]})}},3681:(e,r,t)=>{"use strict";t.d(r,{X:()=>s});var s=function(e){return e.USER="USER",e.ADMIN="ADMIN",e}({})},9615:(e,r,t)=>{"use strict";t.d(r,{ProductProvider:()=>c,Q:()=>d});var s=t(5155),a=t(2115);let o=(0,a.createContext)(void 0),i=[{id:"1",name:"Wireless Headphones",description:"Premium wireless headphones with noise cancellation",price:199.99,category:"electronics",categoryName:"Electronics",image:"https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=500&auto=format&fit=crop&q=60",stock:100,isFeatured:!0,isOnSale:!1},{id:"2",name:"Smart Watch",description:"Track your fitness and stay connected",price:249.99,category:"electronics",categoryName:"Electronics",image:"https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=500&auto=format&fit=crop&q=60",stock:50,isFeatured:!1,isOnSale:!0}];function c(e){let{children:r}=e,[t,c]=(0,a.useState)([]);return(0,a.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("products");e?c(JSON.parse(e)):(c(i),localStorage.setItem("products",JSON.stringify(i)))}catch(e){console.error("Error loading products:",e),c(i)}})()},[]),(0,a.useEffect)(()=>{let e=localStorage.getItem("adminUpdatedProducts");if(e)try{let r=JSON.parse(e),s=[...t];r.forEach(e=>{let r=s.findIndex(r=>r.id===e.id);-1!==r?s[r]=e:s.push(e)}),c(s),localStorage.setItem("products",JSON.stringify(s)),localStorage.removeItem("adminUpdatedProducts")}catch(e){console.error("Error syncing admin products:",e)}},[t]),(0,s.jsx)(o.Provider,{value:{products:t,addProduct:e=>{let r=[...t,e];c(r),localStorage.setItem("products",JSON.stringify(r))},updateProduct:e=>{let r=t.map(r=>r.id===e.id?e:r);c(r),localStorage.setItem("products",JSON.stringify(r))},deleteProduct:e=>{let r=t.filter(r=>r.id!==e);c(r),localStorage.setItem("products",JSON.stringify(r))},getProduct:e=>t.find(r=>r.id===e),refreshProducts:()=>{try{let e=localStorage.getItem("products");e&&c(JSON.parse(e))}catch(e){console.error("Error refreshing products:",e)}}},children:r})}function d(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useProducts must be used within a ProductProvider");return e}}},e=>{var r=r=>e(e.s=r);e.O(0,[8173,2615,8441,1517,7358],()=>r(395)),_N_E=e.O()}]);